-- Sample program for Pong

mode Pong {

  const {
    START_POS: byte = 100     -- sort of middle starting position
    MIN_POS:   byte =  20
    MAX_POS:   byte = 200
  }

  state {
    left_pts:  byte
    right_pts: byte
    left_bar:  sprite Ball
    right_bar: sprite Ball
  }

  init {
    left_pts  <- 0
    right_pts <- 0
  }

  main {
    --     
    if con1.holding(BUTTON_UP) then {
    -- I'm thinking `con1` and `con2` are namespaces, not a value (method call)
    -- `holding` could be implemented as a macro or inlined function
      if left_pos >= MIN_POS then {   -- compare with immediate
        left_pos <- left_pos - 1  -- optimize as decrement operation
      }
    } else if con1.holding(BUTTON_DOWN) then {
      if left_pos <= MAX_POS then {
        left_pos <- left_pos + 1
      }      
    }
    {-
      repeat the routine above except con1 -> con2, left -> right
    -}
  }

  sprite {
    graphics {
      ball
    }

    palettes {
      white
    }

    state {
      direction: enum { LEFT, RIGHT } -- direction of ball
          -- enums? could also be simple ints
    }

    frames {

    }

    init {
      direction <- if random(2) = 0 then LEFT else RIGHT
    }

    loop {
      if direction = left 
    }
  }


}

